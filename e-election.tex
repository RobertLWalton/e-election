% Electronic Election System
%
% File:         e-election.tex
% Author:       Bob Walton (walton@acm.org)
% Date:		See \date below.

\documentclass[12pt]{article}

\usepackage{times}
\usepackage{makeidx}

\makeindex

\setlength{\oddsidemargin}{0in}
\setlength{\evensidemargin}{0in}
\setlength{\textwidth}{6.5in}
\raggedbottom

\setlength{\unitlength}{1in}

\pagestyle{headings}
\setlength{\parindent}{0.0in}
\setlength{\parskip}{1ex}

% Begin \tableofcontents surgery.

\newcount\AtCatcode
\AtCatcode=\catcode`@
\catcode `@=11	% @ is now a letter

\renewcommand{\contentsname}{}
\renewcommand\l@section{\@dottedtocline{1}{0.1em}{1.4em}}
\renewcommand\l@table{\@dottedtocline{1}{0.1em}{1.4em}}
\renewcommand\tableofcontents{%
    \begin{list}{}%
	     {\setlength{\itemsep}{0in}%
	      \setlength{\topsep}{0in}%
	      \setlength{\parsep}{1ex}%
	      \setlength{\labelwidth}{0in}%
	      \setlength{\baselineskip}{1.5ex}%
	      \setlength{\leftmargin}{0.8in}%
	      \setlength{\rightmargin}{0.8in}}%
    \item\@starttoc{toc}%
    \end{list}}
\renewcommand\listoftables{%
    \begin{list}{}%
	     {\setlength{\itemsep}{0in}%
	      \setlength{\topsep}{0in}%
	      \setlength{\parsep}{1ex}%
	      \setlength{\labelwidth}{0in}%
	      \setlength{\baselineskip}{1.5ex}%
	      \setlength{\leftmargin}{1.0in}%
	      \setlength{\rightmargin}{1.0in}%
	      }%
    \item\@starttoc{lot}%
    \end{list}}

\catcode `@=\AtCatcode	% @ is now restored

% End \tableofcontents surgery.

\newcommand{\CN}[2]%	Change Notice.
    {\hspace*{0in}\marginpar{\sloppy \raggedright \it \footnotesize
     $^{\mbox{#1}}$#2}}
    % Change notice.

\newcommand{\figref}[1]{\ref{#1}$\,^{p\,\pageref{#1}}$}
\newcommand{\pagref}[1]{(see page~\pageref{#1} below)}
\newcommand{\pagnote}[1]{$\,^{p\,\pageref{#1}}$}

\newcommand{\EOL}{\penalty \exhyphenpenalty}

\newlength{\figurewidth}
\setlength{\figurewidth}{\textwidth}
\addtolength{\figurewidth}{-0.40in}

\newsavebox{\figurebox}

\newenvironment{boxedfigure}[1][!btp]%
	{\begin{figure*}[#1]
	 \begin{lrbox}{\figurebox}
	 \begin{minipage}{\figurewidth}

	 \vspace*{1ex}}%
	{
	 \vspace*{1ex}

	 \end{minipage}
	 \end{lrbox}
	 \begin{center}
	 \fbox{\hspace*{0.1in}\usebox{\figurebox}\hspace*{0.1in}}
	 \end{center}
	 \end{figure*}}

\newenvironment{indpar}[1][0.3in]%
	{\begin{list}{}%
		     {\setlength{\itemsep}{0in}%
		      \setlength{\topsep}{0in}%
		      \setlength{\parsep}{1ex}%
		      \setlength{\labelwidth}{#1}%
		      \setlength{\leftmargin}{#1}%
		      \addtolength{\leftmargin}{\labelsep}}%
	 \item}%
	{\end{list}}


\begin{document}
        
\title{An Electronic Election System}

\author{Robert L. Walton\thanks{Copyright 2019 Robert L. Walton.
Permission to copy this document {\bf verbatim} is granted by the author
to the public.}}

\date{August 3, 2019}

\maketitle

\begin{center}
\large \bf Table of Contents
\end{center}

\bigskip

\tableofcontents 

\newpage

\section{Introduction}

Our purpose is to specify an all-electronic election E-Election System
suitable for replacing the current optical paper system
used in Massachusetts.  Our system is based on the notion
of `tamper proof software', which is software that is
known to do what it should do.

\section{Outline}

A Private Voting Machine
(PVM) is constructed from a single thumb drive and a
registration card.  Part of the thumb drive contains the
tamper proof software of the PVM, part contains an encrypted
data set called a Voter Lock Box (V-Box), and the registration
card contains a passkey that is entered on the keyboard in
order to decrypt/encrypt the V-Box.  The software runs on
a (fairly) arbitrary computer, is bootstrapped directly,
runs without using any operating system or BIOS,
uses only RAM memory during operation,
writes the encrypted V-Box back to the thumb drive, and sends
a very few encrypted messages to other `machines' in the
system.

The other machines are the Registration Machines, which make
ready-to-mark ballots available and time-stamp and certify
encrypted finished ballots; the Collection Machines that collect
finished ballots; and the Counting Machines that count the
ballots.  Each machine has the same design as the PVM, except
these other machines have different software,
are each run by a single election official instead of a voter, and
are replicated with different officials running different
replicas.  Counting Machines also use separate
thumb drives containing master lock boxes
(M-Boxes), and a Counting Machine requires
5 out of 10 election officials to cooperatively
provide decrypted M-Boxes in order to decrypt ballots and
produce final counts.

Each Machine and each M-Box has a public key and a private key.
Each precinct has its own separate set of Counting Machines and M-Boxes,
but precincts may share Collection Machines and Registration
Machines.

Collection Machines,
Counting Machines, and M-Boxes may be
specific to a particular election, but Registration Machines
and Private Voting Machines and
their public keys are shared across multiple elections.

\section{Advantages}

The main advantages of the E-Election System are:
\begin{enumerate}
\item Substantially reduced election staff manpower.
\item Substantially decreased cost of running an election.
\item Substantially increased ease of voting.
\end{enumerate}

Hopefully these advantages will eventually lead to
greater voter turnout and more frequent use of elections such
as referendums to let the voters decide issues directly
(as is done in Switzerland).


\section{Tamper Proof Software}

Tamper Proof Software is software written in a `tamper proof'
programming language
that has the following property:
\begin{indpar}
The translation of source code to binary files is so precisely
specified that several independent groups of programmers can
write compilers that will produce identical binaries from any
given source.
\end{indpar}

Clearly a sufficiently simple assembly language qualifies, but
we need a somewhat higher level language.  Still, such a language
should be possible.  Two aids to this end are:
\begin{enumerate}
\item
Computer efficiency is not required in this application.

\item
If two compilers disagree on some source, the matter can be
investigated, and either one or both compilers fixed, or the
language specification improved.
\end{enumerate}

The real goal is obtaining binaries that can be trusted to
do what the source code says they should do.  The other
property of tamper proof software is that the source code
is published, so the world can see what it does and look
for flaws.

The simplest tamper proof programming language is a straight
forward simple assembly language.  Given this, one can write
an interpreter for a simple interpreted language in the
assembly language.  The interpreted language should suffice
for most of the code, and can be machine independent.
A few functions can be optimized by being written in assembly
language.

\section{Software Distribution}\label{SOFTWARE-DISTRIBUTION}

Since the software is published and compilers for its tamper-proof
language are to be readily available, it is easy to make deviant
versions of the software.\label{DEVIANT-SOFTWARE}

Thus the binaries that can be trusted must be reliably distributed.

The software for one of the E-Election
System machines will be a set of read-only files, one of which will be
the boot file that runs during startup.\footnote{For example, all
the software but device drivers may be in the boot file, with each
device driver being in a separate file.  With this scheme no file
need be more than several megabytes in size, and files can be
requested individually if only some have been upgraded.}

The files and the
and their cryptographic hashes (e.g., SHA-256) will be available on multiple
web sites.  Only the cryptographic hash of the boot file needs to be checked,
as it will contain cryptographic hashes of the other files and will check
the other files before they are used in running the machine.
Widely available commodity software running under commodity operating systems
can be used to check the cryptographic hash of the boot file.

To avoid hacking by commodity software during a cryptographic hash check,
the E-Election Machine thumb drive should have a physical read-only
switch.

The software files will be on
the same thumb drive as their associated machine's locked box, and
therefore cannot be substituted by switching thumb drives.

Private Voting Machines would be created by the town clerk.
Software updates for the Private Voting Machines are distributed
by the Registration Machines.  Therefore Private Voting Machines
would only need to have their file cryptographic hashes checked if the voter
suspected that someone physically tampered with the machine's thumb drive.



\section{Keys and Names}

Each locked box in the system has a passkey, which is
written on a registration card associated with the locked
box.  Passkeys are generated by the system, and not by
people.  Typical passkeys consist of 2 or 3 pseudo-words
and 4 to 6 digits, chosen at random.  An example is
`vox64bam45zip01'.  A pseudo-word is equivalent to 3
digits, so this example is the equivalent of 15 random
digits, but the pseudo-words if chosen to be pronounceable
tend to make the passkey easier to type.

Each machine has a locked box.  Each precinct
has 10 additional locked M-Boxes.

Each machine and each M-Box has a public key and a private key.  These
are long, e.g. 4,096 bit, values constructed randomly
in public/private pairs.
These are \underline{not} the same as the passkey of any locked box.
Passkeys are symmetric encryption keys.

Each Machine
has a Unique ID, or UID, which is a 1024 bit random number
used to identify the machine.  This UID serves as the
machine's name.

Each M-box for a precinct and election has a number from 1 though 10.

Each Registration and Collection Machine has a URL.

The correspondence between Private Voting Machine UIDs
and voter names and addresses is not part of the E-Election system
described here.  The E-Election system only knows about
Private Voting Machines identified by their UIDs.
Generally the correspondence between UIDs and voter names and addresses
would only be made available
to organizations and people authorized by state law.
For example, Massachusetts currently makes voter registration lists
available to registered political parties.

When one machine sends a message to another, the sender
encrypts the message proper with the sender's private
key, and attaches the unencrypted sender's UID to the
message.  Then the sender encrypts the message with the
receiver's public key.  The sender must have the receiver's
public key, and the receiver must have the sender's public
key.  Public keys are not published,
though the system is designed so that publishing public
keys will not compromise security or essential privacy,
and a voter can find out the public keys of Registration
Machines and Collection Machines by examining his/her locked
box using deviant software to decrypt and
display the locked box (see \pageref{DEVIANT-SOFTWARE} above).

Note that Counting Machines are never given Private Voting
Machine UIDs or public keys, and can never associate an
encrypted ballot with a particular Private Voting Machine.

\section{Registration Machine Details}

A Registration Machine is run by a single election official
who holds the registration card containing the the passkey to
the machine's locked box.  The Registration Machine in this
sense is specific to a particular election, but the
URL naming the Registration Machine and the machine's
public/private key pair will typically remain the same across
several elections.

The locked box of a Registration Machine contains:
\begin{enumerate}
\item The private key of the Registration Machine.
\item Public keys of all Registration Machines, all Collection
Machines, and all M-Boxes.
\item Machine UIDs and URLs of all Registration Machines and all Collection
Machines.
\item The unmarked ballot.
\item UIDs and associated public keys of all Private Voting
Machines.  This includes de-registered and test Private Voting
Machines, as Registration Machines do not know which Private Voting
Machines are de-registered or test machines.
\item A log of any transactions the Registration Machine has
been involved in, including  Certificates issued by the Registration Machine.
Private Voting Machines are identified by their UID and not by the
name/address of their voter.

During the election the portion of the log involving transactions with
a particular Private Voting Machine is visible to that Private Voting
Machine.  \underline{After} the election the entire log will be available to
to the public under the same terms as voter registration lists are
available (e.g., in Massachusetts they are available to registered
political parties).
\item Information about Private Voting Machine Software, including
complete copies of recent versions, and version numbers and
cryptographic hashes of both recent and deprecated versions.
\item UIDs, URLs, and public keys of Registration Machines that will be used
in future elections and Registration Machines that were used in previous
elections and have been removed from service.
\end{enumerate}

A Registration Machine receives four kinds of requests from
Private Voting Machines:
\begin{enumerate}

\item
Request for Ballot.  The reply includes:
\begin{enumerate}
\item The unmarked ballot.
\item UIDs, URLs, and public keys
      of Registration Machines and Collection Machines being used
      in the election.
\item Public keys of M-Boxes being used in the election.
\item Version numbers and cryptographic hashes
      of Private Voting Machine software
      known to the Registration Machine, and
      the status of each version, active or deprecated.
\item UIDs, URLs, public keys, and status of Registration Machines not
      being used in the current election because they have been removed
      from service or are to be used in a future election.
\item A long truly random bit string, for use only if the
      Private Voting Machine hardware does not have its own hardware
      random number generator (most recent computer processors have
      such).  If this has to be used, it will be exclusively OR'ed with
      the random bit strings of at least 2 other Registration Machines
      so no one Registration Machine will know the random numbers being
      used.
\end{enumerate}

\item
Request for Certificate.  The request includes the cryptographic hash
of an encrypted ballot prepared by the requesting Private
Voting Machine.  The reply is a certificate containing
the cryptographic hash of the encrypted ballot,
the Registration Machine and Private Voting Machine UIDs,
the date and time according to the Registration Machine,
and a digital signature of the certificate by the Registration Machine
\pagref{CERTIFICATE-DETAILS}.

\item
Request for Log.  The log entries created by requests from the
requesting Private Voting Machine are returned in the reply.

\item
Request for Software.  The version of Private Voting Machine software
requested is returned in the reply.

\end{enumerate}

Requesters are always Private Voting Machines, and all replies
are sent to just the requester.  All requests are logged.

A Registration Machine may serve requests from more than
one precinct, but the election information flow remains specific
to the precinct.  Each precinct should have at least 3
Registration Machines available.

Note that Private Voting Machines have no concept of time.
If they cannot contact Registration Machines used in the last
election, they will try to contact Registration Machines
slated for use in future elections, and if successful, will
update their locked box according the Request for Ballot
replies of these Registration Machines.

\section{Private Voting Machine Details}

A Private Voting Machine is run by a single voter
who holds the registration card containing the passkey to
the machine's locked box.  Usually a Private Voting Machine
is used by its voter for multiple elections over a period
of several years, after which the Private Voting Machine
is de-registered and a new Private Voting Machine
is given to the voter.

Initially the locked box of a Private Voting Machine contains:
\newcounter{PVM-COUNTER}
\begin{enumerate}
\item The UID of the Private Voting Machine.
\item The public and private key of the Private Voting Machine.
\item Public keys, UIDs, URLs, and status of some Registration Machines.
\item Version number and cryptographic hash of Private Voting Machine's current
      software.
\setcounter{PVM-COUNTER}{\value{enumi}}
\end{enumerate}

The Private Voting Machine
makes requests of Registration Machines.  In every case
at least 3 Registration Machines should be used and the
results compared to avoid single point failures or corruption.

The first thing a Private Voting Machine does, when prompted by
its voter, is make a Request for Ballot and use the replies to
add to its locked box the following information:
\begin{enumerate}
\setcounter{enumi}{\value{PVM-COUNTER}}
\item URLs, public keys, and UIDs
of all Registration Machines and all Collection
Machines used in the current election.
\item Public keys of the M-Boxes used in the current election.
\item The unmarked ballot.
\item UIDs, public keys, and URLs of Registration Machines that are
obsolete or will be used in future elections.
\item Version numbers and cryptographic hashes of different Private
Voting Machine software versions known to the Registration Machines.
\item The exclusive OR of the random bit strings provided by the
Registration Machines, if this is needed.
\end{enumerate}
This can be done days or just minutes before the voter votes.

At this point
the voter may or may not choose to update Private Voting Machine
software using a Request for Software made to the Registration Machines.

The next step is for the voter to vote by marking the ballot.

After it is marked the ballot is encrypted and certified.  Encryption of the
ballot is described below.  To certify the ballot, a cryptographic hash
is computed of the encrypted ballot, and the cryptographic hash is sent
in a Request to Certify message to each of at least three Registration
Machines.  These in turn send back certificates that are appended
to the encrypted ballot to form the submitted ballot.  Each
certificate contains the cryptographic hash of the encrypted ballot, the
UIDs of the Private Voting Machine and Registration Machine,
and a time stamp.  The certificates
are signed by the Registration Machines but are \underline{not} encrypted.
The certificates are copied to the Registration Machine log, and can be
be viewed by the public.

The submitted ballot is now sent by the Private Voting
Machine to at least three Collection Machines.  The submitted
ballot contains:
\begin{enumerate}
\item The encrypted ballot.
\item Certificates received for the encrypted ballot.  Each contains the
UIDs of the Private Voting Machine and certifying Registration Machine.
\item A copy of the unencrypted \underline{unmarked} ballot, for
diagnostic purposes.
\item Version number of the Private Voting Machine software, for
diagnostic purposes.
\item Digital signature of the submitted ballot, computed by the
Private Voting Machine using its private key.
\end{enumerate}


A voter may change her/his mind and re-vote.  The last ballot
he/she casts counts.  This is rather important in an election,
as on the one hand a voter may receive new information and
want to change the vote, and on the other hand to avoid system
congestion it is convenient to have votes strung out over time.

\section{Ballot Encryption Details}

The ballot is encrypted as follows.

First, the ballot is embedded in a long random bit string.
This is done because in a typical election most marked ballots will
have only a few possible values.  For example, if there are only
6 contested elections with only 2 candidates each, there would only
be 64 possible marked ballots, exclusive of write-ins.

One method would be to generate a long random bit string and then
use the first part of this as instructions to copy the ballot voting bits into
various random places in the remainder of the random bit string.\footnote{
This is one of many ways of `adding entropy' to the message.}

Second, a random symmetric key S is generated and used to encrypt
the randomized ballot.  Then 10 more random keys K1, ..., K10 are generated
and used in 5-way Shamir's Secret Sharing encryption
scheme to encrypt S.  The 5-way
scheme is such that any 5 of the 10 K-keys can decrypt the encrypted S.
Then each of the 10 K-keys is encrypted by the public key
of a different one of the 10 M-boxes.

The encrypted ballot consists of:
\begin{enumerate}
\item The random bit string containing the embedded ballot,
      encrypted with the S key.
\item The S key encrypted with the 10 K-keys according to
      Shamir's Secret Sharing scheme.
\item The 10 K-Keys each encrypted with a
      different one of the 10 M-Box public keys.
\end{enumerate}
The encrypted ballot can be decrypted
by any 5 M-boxes private keys.
It does \underline{not} contain the voter's UID.

\section{Certificate Details}
\label{CERTIFICATE-DETAILS}

For each encrypted ballot, several certificates are generated
by Registration Machines acting independently.  Each certificate
contains:
\begin{enumerate}
\item UID of the Private Voting Machine submitting the encrypted ballot.
\item UID of the Registration Machine certifying the ballot.
\item Date and time, as computed by the Registration Machine.
\item Cryptographic hash of the encrypted ballot as computed by the
      Private Voting Machine.  The encrypted ballot itself is
      \underline{never} sent to the Registration Machine.
\item Digital signature of the certificate computed
by the Registration Machine using its private key.
\end{enumerate}

\section{Collection Machine Details}

The Collection Machines receive the submitted ballots, each containing
an encrypted ballot and at least 3 certificates for the encrypted
ballot.

The locked box of a Collection Machine initially contains:
\begin{enumerate}
\newcounter{CML-COUNTER}
\item The private key of the Collection Machine.
\item UIDs and public keys of all Registration, Collection, and Counting
      Machines.
\item The unmarked ballot.
\item UIDs and associated public keys of all Private Voting
Machines.  This includes de-registered and test Private Voting
Machines, as Collection Machines do not initially know which Private Voting
Machines are de-registered or test machines.
\setcounter{CML-COUNTER}{\value{enumi}}
\end{enumerate}

During voting the collection machines may receive updates to the
list UIDs and public keys of Private Voting Machines, and will
receive submitted ballots.  The later cause the following to be
added to the Collection Machine locked box:

\begin{enumerate}
\setcounter{enumi}{\value{CML-COUNTER}}
\item The set of all accepted submitted ballots sent to the collection machine
by Private Voting Machines.
\setcounter{CML-COUNTER}{\value{enumi}}
\end{enumerate}

Collection Machines receive and process two kinds of requests from
Private Voting Machines:
\begin{enumerate}

\item
Ballot Submission.  The Private Voting Machine uses this to sent
its submitted ballot to the Collection Machine.  The latter accepts
the submitted ballot if its Registration Machine certificate checks,
all the digital signatures check, and the cryptographic hashes of the
encrypted ballot check, and rejects the submitted
ballot otherwise.  Note that a message not correctly encrypted with
the private key of the submitting Private Voting Machine and the
public key of the receiving Collection Machine is ignored.

Accepted submitted ballots are added to the locked box of the
Collection Machine.

\item
Submission Check.  The Collection Machine sends a reply containing
the certificates of accepted submitted ballots
that were sent to the Collection Machine
by the Private Voting Machine, if any.

\end{enumerate}

Note that messages received that cannot be decrypted using the
private key of the Collection Machine
are discarded, and so cannot contain
ballots that are either valid or invalid.  Collection Machine
public/private key pairs are election specific, so ballots for
the wrong election will not be considered.

At the end of voting Collection Machines are disconnected from
the internet.  They then
\begin{enumerate}
\newcounter{CMC-COUNTER}
\item Receive the UIDs and public keys of all Collection Machines and
Counting Machines.
\item Transmit to each other their sets of accepted submitted ballots.
\item Merge into their own set of accepted submitted ballots any
received from other Collection Machines that they did not have previously.
At this point, all Collection Machines have the same set of accepted
submitted ballots.
\setcounter{CMC-COUNTER}{\value{enumi}}
\end{enumerate}

Lastly, Collection Machines participate with Counting Machines to
produce vote counts.  More than one vote count will be produced:
e.g., a count of initial valid votes, a re-count that includes
allowed provisional votes, a re-count that includes test votes.
The Collection Machine's job is to prepare for each vote count
the set of valid ballots and submit this set to the Counting Machines.
To do this the Collection Machines:

\begin{enumerate}
\setcounter{enumi}{\value{CMC-COUNTER}}
\item Receive from outside the E-Election System a list of UIDs of
Private Voting Machines that are valid for the vote count.
E.g., for the initial vote count a Private Voting Machine would
be valid unless it is de-registered, provisional, or a test machine.
\item Create a set of valid ballots (defined below)
which are to be submitted to the Counting Machines.
\item Separated this set of valid ballots into a set of ballot headers
and a set of encrypted ballots.  The header of a submitted ballot is
everything but the encrypted ballot contained therein.  In particular
the certificates are in the header.
\item Transfer the set of encrypted ballots to each Counting Machine.
\end{enumerate}

Since the Collection Machines are disconnected from the internet,
data transfers are made by copying to and from thumb drives, or by
a network physically separate from the internet.

A ballot is valid unless:

\begin{enumerate}
\item It has been superseded by a later ballot from the same
Private Voting Machine.
\item It is from a Private Voting Machine that is not valid.
\end{enumerate}

Information specific to a particular vote count, e.g., the
list of valid Private Voting Machines and set of valid ballots,
is \underline{not} added to the Collection Machine locked box,
so that a Collection Machine has no memory of past vote counts.
This is an aid to testing \pagref{TESTING}.

\section{Counting Machine Details}

Counting is done separately for each vote count.

Counting Machines receive a complete sorted set of encrypted ballots
from each collection machine, and check to be sure these sets
are the same.  Using cryptographic hashes of the sets, the Counting
Machines check that each Counting Machine has received the same set.

Each Counting Machine is then given 5 M-boxes and proceeds to
decrypt and count the ballots.  The Counting Machines then compare
the counts to verify that all Counting Machines go the same counts.

An M-box contains nothing but its number (1 though 10)
and the private key of the M-box.

The Counting Machine locked box contains nothing but the UIDs
and public keys of all Collection Machines and Counting Machines.
It does not contain any information specific to a vote count,
as an aid to testing \pagref{TESTING}.

Write-ins can be tabulated by the Counting Machines in a manner
generally similar to regular votes.  A write-in is a piece of
text, and counts can be given each piece of text and for groups
of similar pieces of text.

\section{De-Registration}

If a Private Voting Machine (i.e., its thumb drive and registration
card) is lost or stolen, the voter may have the machine
de-registered\label{DE-REGISTERED}
and replaced by a new Private Voting Machine.

\section{Testing}\label{TESTING}

All election machines are in triplicate copies which check up on each
other, except the Private Voting Machines.  Therefore testing
for security and other problems is centered on the Private Voting
Machines.

The basic E-Election System philosophy of testing is to run tests
that appear to hardware just like real election runs.  Then if
some hardware is hacked and corrupts the result, the corruption
will be found out.  For this to work, it is important that the
hardware not be able to distinguish a test run from a real election run.

Some Private Voting Machines are designated as
`test machines'\label{TEST-MACHINE}.
These are used by election officials to cast known votes that can
be checked to ensure that the system and hardware is working as
desired.  These test votes are cast during the normal election
period, using the same Registration and Collection Machines
as official votes, and in fact the Registration and Collection Machines
do not know the difference between a test vote and an official vote
until after voting is finished.

To check test votes, a re-count is done with both valid Private Voting
Machines and Test Private Voting Machines presented as valid to the
Collection Machines.  The difference between the official count and
this re-count should be exactly the votes from the test machines.

None of the E-Election Computers will be able to distinguish
test voting or test counting from real election voting and counting.
In particular, the Collection and Counting Machines cannot use the
number of valid Private Voting Machines in a count as an indicator
of the presence of test votes, as the numbers will be similar in the
official count and the test re-count, and these machines retain no
records of previous vote counts in their locked boxes.

Test Private Voting Machines should be run on the same kinds of
hardware that real voters use, so if computers manufactured by a
particular vendor are hacked, the hack will be detected.


\section{Vote Buying}

No voting system prevents a person who knows a voter well from
`buying' the voter's vote with some favor.

However buying votes on a large enough scale to influence elections
is difficult to do without being detected and prosecuted.
This is just as true of our proposed E-Election System as of
current voting systems.

The only thing easier to do in the E-Election System is verification
that a vote bought from a stranger
is what the buyer wants it to be.  The E-Election
System shares this with absentee voting systems.  However, since its
nearly impossible to buy large numbers of votes without being detected,
such easier verification is not significant.

As an added safe-guard an e-mail or letter may be sent to each voter after the
election telling the voter when they voted, just in case the voter's
Private Voting Machine has been `stolen' by an unscrupulous friend.

\section{Voter Suppression}

Attempts to suppress votes are more common than attempts to buy votes.

Using Registration Machines to distribute updates for Registration
Machine lists and software should make voter suppression very difficult.
It would probably be a good idea, however, to have each voter come into
the voter registration office once every 5 years to get a new
Private Voting Machine, at which time their old one is de-registered.

Because voters can check the logs of Registration and Collection Machines
for summary information about the votes that the voter's Private Voting Machine
has cast, it should be very difficult to suppress votes and not be detected.

\section{Election Preparation}

There are many ways to prepare the various Machines needed in an election,
and the one we outline here is but an example.

The town holding the election has 3 preparation computers that are
connected to each other by a physical network but which are not
physically connected to the internet.  To avoid hacked hardware
produced by a single vendor, the 3 computers are from different
computer vendors.  Each has a good hardware random number generator
(as is built into most modern processors).

Assume that election is going to be carried out by 3 election
officials, each responsible for 1 Registration Machine, 1 Collection
Machine, and 1 Counting Machine.  They each use a different one of
the 3 preparation computers.

An election Machine can make its own locked box containing its UID
and public/private key.  Initially the software for the machine
is copied from the internet to the Machine's thumb drive,
the cryptographic hash of its boot file is obtained by examining
and crosschecking multiple public web pages, the thumb
drive is set read-only with a physical switch and the cryptographic
hash of its boot file is checked using commodity software.
Then the Machine is run and makes its own initial locked box.

So first the 3 election officials each make a Counting Machine,
each Counting Machine makes 3 or 4 of the M-Boxes.  Then
the Counting Machines exchange their UIDs and public keys and M-Box
numbers and public keys over the local net
and each writes a separate Counting Machine information
thumb drive containing all the
Counting Machine UIDs and public keys and all the M-Box numbers and
public keys.  These Counting Machine information
thumb drives are identical and are made read-only.

Then the 3 election officials each make a Collection Machine
that takes a Counting Machine information thumb drive as input,
and produces a Collection Machine information drive containing
the URLs, UIDs, and public keys of all the Collection Machines.

Then the 3 election officials each make a Registration Machine
that takes the Counting and Collection Machine information
drives as input.  However the Registration Machines take
a pre-prepared additional input thumb drive that contains
their public/private keys and URLs, as these must be known
long in advance in order to prepare Private Voting Machines.
The Registration Machines create their own UIDs
and produce a Registration Machine information
drive containing the URLs, UIDs, and public keys of all Registration
Machines.

Then the Registration Machine information thumb drives are each input
to a Collection Machine which adds the Registration Machine
UIDs and public keys to its locked
box, and the Collection Machine information thumb drives are each
input to a Counting Machine which adds the Collection Machine
UIDs and public keys to its locked box.

In addition 3 thumb drives each containing the UIDs and public
keys of all the initially known Private Voting Machines plus
the unmarked ballot are
each input to one of the Registration Machines and one of the
Collection Machines which add this information to their locked
box.

When not being used for all this the preparation machines can
be used to create Private Voting Machines that are not yet
assigned to a voter, and record their UIDs and public keys
in a separate data base.  Each of these can then be given to a voter
and its UID can be recorded in the separate database that records
the name, address, and birthday of the voter.  From this
data base thumb drives containing UIDs and public keys of
Private Voting Machines can be prepared and passed to the
Collection Machines and Registration Machines which will add
initial or new information to their locked boxes.

The preparation machines, when not being used otherwise, can
be used to maintain the data base of Private Voting Machine
UIDs and public keys,
the voter data base, and the data base of
Registration Machine URLs and public/private keys.
These data bases can have triplicate copies, each maintained
by one of the preparation machines.  These data bases should
be log based: each is has an underlying log of all changes
that is only added to and never otherwise modified,
and the database can be remade at any point by executing the
operations in the log.

Election officials need not know the details above.
They merely need to be able to follow a script that tells
them when to create a new writable thumb drive with a particular
label, when to insert a thumb drive with a particular label
as read-only or writable, when to boot the computer,
and when to remove a thumb drive with a particular label.
A small amount of information may be collected when the programs run,
e.g., the URLs of the Collection Machines.


\section{Other Considerations}

There are other considerations that need to be taken into
account when producing an E-Election System.  Some of these,
with suggestions for dealing with them, are as follows.

\subsection{Denial of Service}

Standard methods need to be employed to prevent Registration and
Collection Machines from being overloaded by spurious internet packets.
However as the voting period will be one or several weeks, such
overloading is unlikely to be more than a nuisance.

To prevent overloading the memory used to hold the locked boxes,
Registration Machines and Collection Machines need to limit the
number of requests they receive from a particular Private Voting Machine.
If these limits need to be legitimately expanded for a particular
voter, that voter may have his/her Private Voting Machine de-registered
and get a new Private Voting Machine.

\subsection{Meta-Data}

ISPs will be able to collect meta-data that will allow them to
make good guesses as to which IP addresses were used to cast votes.
However, better information of this kind is made publicly available
(e.g., to registered political parties) after the election anyway,
and ISPs are unlikely to give this meta-data to anyone trying to
guess voter IP addresses.


\end{document}
