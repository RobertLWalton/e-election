% Electronic Election System
%
% File:         e-election.tex
% Author:       Bob Walton (walton@acm.org)
% Date:		See \date below.

\documentclass[12pt]{article}

\usepackage{times}
\usepackage{makeidx}

\makeindex

\setlength{\oddsidemargin}{0in}
\setlength{\evensidemargin}{0in}
\setlength{\textwidth}{6.5in}
\raggedbottom

\setlength{\unitlength}{1in}

\pagestyle{headings}
\setlength{\parindent}{0.0in}
\setlength{\parskip}{1ex}

% Begin \tableofcontents surgery.

\newcount\AtCatcode
\AtCatcode=\catcode`@
\catcode `@=11	% @ is now a letter

\renewcommand{\contentsname}{}
\renewcommand\l@section{\@dottedtocline{1}{0.1em}{1.4em}}
\renewcommand\l@table{\@dottedtocline{1}{0.1em}{1.4em}}
\renewcommand\tableofcontents{%
    \begin{list}{}%
	     {\setlength{\itemsep}{0in}%
	      \setlength{\topsep}{0in}%
	      \setlength{\parsep}{1ex}%
	      \setlength{\labelwidth}{0in}%
	      \setlength{\baselineskip}{1.5ex}%
	      \setlength{\leftmargin}{0.8in}%
	      \setlength{\rightmargin}{0.8in}}%
    \item\@starttoc{toc}%
    \end{list}}
\renewcommand\listoftables{%
    \begin{list}{}%
	     {\setlength{\itemsep}{0in}%
	      \setlength{\topsep}{0in}%
	      \setlength{\parsep}{1ex}%
	      \setlength{\labelwidth}{0in}%
	      \setlength{\baselineskip}{1.5ex}%
	      \setlength{\leftmargin}{1.0in}%
	      \setlength{\rightmargin}{1.0in}%
	      }%
    \item\@starttoc{lot}%
    \end{list}}

\catcode `@=\AtCatcode	% @ is now restored

% End \tableofcontents surgery.

\newcommand{\CN}[2]%	Change Notice.
    {\hspace*{0in}\marginpar{\sloppy \raggedright \it \footnotesize
     $^{\mbox{#1}}$#2}}
    % Change notice.

\newcommand{\figref}[1]{\ref{#1}$\,^{p\,\pageref{#1}}$}
\newcommand{\pagref}[1]{p\pageref{#1}}
\newcommand{\pagnote}[1]{$\,^{p\,\pageref{#1}}$}

\newcommand{\EOL}{\penalty \exhyphenpenalty}

\newlength{\figurewidth}
\setlength{\figurewidth}{\textwidth}
\addtolength{\figurewidth}{-0.40in}

\newsavebox{\figurebox}

\newenvironment{boxedfigure}[1][!btp]%
	{\begin{figure*}[#1]
	 \begin{lrbox}{\figurebox}
	 \begin{minipage}{\figurewidth}

	 \vspace*{1ex}}%
	{
	 \vspace*{1ex}

	 \end{minipage}
	 \end{lrbox}
	 \begin{center}
	 \fbox{\hspace*{0.1in}\usebox{\figurebox}\hspace*{0.1in}}
	 \end{center}
	 \end{figure*}}

\newenvironment{indpar}[1][0.3in]%
	{\begin{list}{}%
		     {\setlength{\itemsep}{0in}%
		      \setlength{\topsep}{0in}%
		      \setlength{\parsep}{1ex}%
		      \setlength{\labelwidth}{#1}%
		      \setlength{\leftmargin}{#1}%
		      \addtolength{\leftmargin}{\labelsep}}%
	 \item}%
	{\end{list}}


\begin{document}
        
\title{An Electronic Election System}

\author{Robert L. Walton\thanks{Copyright 2019 Robert L. Walton.
Permission to copy this document {\bf verbatim} is granted by the author
to the public.}}

\date{June 13, 2019}

\maketitle

\begin{center}
\large \bf Table of Contents
\end{center}

\bigskip

\tableofcontents 

\newpage

\section{Introduction}

Our purpose is to specify an all-electronic election system
suitable for replacing the current optical paper system
used in Massachusetts.  Our system is based on the notion
of `tamper proof software', which is software that is
known to do what it should do.

\section{Outline}

A Private Voting Machine
(PVM) is constructed from a single thumb drive and a
registration card.  Part of the thumb drive contains the
tamper proof software of the PVM, part contains an encryped
data set called a Voter Lock Box (V-Box), and the registration
card contains a passkey that is entered on the keyboard in
order to decrypt/encrypt the V-Box.  The software runs on
a (fairly) arbitrary computer, is bootstrapped directly,
runs without using any operating system or BIOS,
uses only RAM memory during operation,
writes the encryped V-Box back to the thumb drive, and sends
a very few encrypted messages to other `machines' in the
system.

The other machines are the Registration Machines, which make
ready-to-mark ballots available and time-stamp and certify
encrypted finished ballots; the Collection Machines that collect
finished ballots; and the Counting Machines that count the
ballots.  Each machine has the same design as the PVM, except
these other machines are each run by a election officials, and
each are replicated with different officials running different
replicas.  Each Counting Machine also uses separate
thumb drives containing master lock boxes
(M-Boxes), and requires 5 out of 10 election officials to cooperatively
provide decrypted M-Boxes in order to decrypt ballots and
produce final counts.

Each Machine as a public key and a private key (or in the
case of a Counting Machine, 10 private keys).  Each precinct
has its own separate set of Counting Machines and M-Boxes with
private keys.

\section{Tamper Proof Software}

Tamper Proof Software is software written in a programming language
that has the following property:
\begin{indpar}
The translation of souce code to binary files is so precisely
specified, that several independent groups of programmers can
write compilers with will produce identical binaries from any
given source.
\end{indpar}

Clearly a sufficiently simple assembly language qualifies, but
we need a somewhat higher level language.  Still, such a language
should be possible.  Two aids to this end are:
\begin{enumerate}
\item
Computer efficiency is not required in this application.

\item
If two compilers disagree on some source, the matter can be
investigated, and either one or both compilers fixed, or the
language specification improved.
\end{enumerate}

The real goal is obtaining binaries that can be trusted to
do what the source code says they should do.  The other
property of tamper proof software is that the source code
is published, so the world can see what it does and look
for flaws.

\section{Keys and Names}

Each locked box in the system has a passkey, which is
written on a registration card associated with the locked
box.  Passkeys are generated by the system, and not by
people.  Typical passkeys consist of 2 or 3 pseudo-words
and 4 to 6 digits, chosen at random.  An example is
`vox64bam45zip01'.  A pseudo-word is equivalent to 3
digits, so this example is the equivalent of 15 random
digits, but the pseudo-words if chosen to be pronouncable
tend to make the passkey easier to type.

Each machine has a locked box.  Each Counting
Machine has 10 additional locked M-Boxes.

Each machine has a public key and a private key.  These
are long, e.g. 4,096 bit, values constructed randomly
in public/private pairs.

Each Registration and Collection
machine has a URL which serves as its name.

Each Private Voting Machine and each Counting Machine
has a Unique ID, or UID, which is a 1024 bit random number
used to identify the machine.  This UID serves as the
machine's name.

When one machine sends a message to another, the sender
encrypts the message proper with the sender's private
key, and attaches the unencrypted sender's name to the
message.  The receive is expected to have the public
key of the sender.  Thus public keys are not published,
though the system is designed so that publishing public
keys will not compromise security or essentual privacy.

\section{Registration Machine Details}

A Registration Machine is run by a single election official
who holds registration card containing the the passkey to
the machine's locked box.  The
locked box contains:
\begin{enumerate}
\item The private key of the Registration Machine.
\item Public keys of all Registration Machines, all Collection
Machines, and all Counting M-Boxes.
\item Machine names (URLs) of other Registration Machines and all Collection
Machines.
\item The unmarked ballot.
\item UIDs and associated public keys of all registered Private Voting
Machines.
\item A log of any transactions the Registration Machine has
been involved in.
\end{enumerate}

A Registration Machine receives two kinds of requests from
Private Voting Machines:
\begin{enumerate}

\item
Request for Ballot.  The reply includes the unmarked ballot
and any public keys and names of Registration and
Collection Machines known to the Registration Machine,
and also the public keys of any M-Boxes known to the Registration
Machine.

\item
Request for Certificate.  The request includes the signature
of an encrypted ballot prepared by the requesting Private
Voting Machine.  The reply is a certificate containing
the signature, the Private Voting Machine's UID,
and a signature of the certificate by the Registation Machine.

\end{enumerate}

Requests to the Registration Machine are encrypted with the
private key of the requester as a means of certifying that
the request does indeed come from the requester.  However the
unencrypted public key of the requester is included in the
request in order to identify the requester.  Requesters are
always Private Voting Machines.

Replys are encrypted with the private key of the replying Registration Machine.

A Registration Machine also permits the public to view online
its log and all data except the Registration Machine's
private key.  The voting list, which associates each Private
Voting Machine public key with a voter name, address, sex,
age, etc., is \underline{not} part of this electronic
election system (but might be in an adjunct to this system).

A Registration Machine may serve requests from more than
one precinct, but the information flow remains specific
to the precinct.  Each precinct should have at least 3
Registration Machines available.

\section{Private Voting Machine Details}

A Private Voting Machine is run by a single voter
who holds the registration card containing the passkey to
the machine's locked box.

Initially the locked box contains:
\newcounter{PVM-COUNTER}
\begin{enumerate}
\item The public and private key of the Private Voting Machine.
\item Public keys of all Registration Machines.
\setcounter{PVM-COUNTER}{\value{enumi}}
\end{enumerate}

The Private Voting Machine
makes requests of Registration Machines.  In every case
at least 3 Registration Machines should be used and the
results compared or tabulated to avoid single point failures.

The first thing a Private Voting Machine does, when prompted by
its voter, is make a Request Ballot, and use the replies to
add to its locked box the following information:
\begin{enumerate}
\setcounter{enumi}{\value{PVM-COUNTER}}
\item Public keys of all Registration Machines, all Collection
Machines, and all Counting M-Boxes.
\item Machine names (URLs) of all Registration Machines and all Collection
Machines.
\item The unmarked ballot.
\end{enumerate}
This can be done days or just minutes before the voter votes.

\end{document}
